(this.webpackJsonpimageviewer=this.webpackJsonpimageviewer||[]).push([[0],{102:function(e,t,a){(t=a(23)(!1)).push([e.i,".ImageViewer__inlineBlock___3x7PU{display:inline-block;width:75px}.ImageViewer__overlay___jS0Z0{position:absolute;max-width:100%;height:20px;z-index:10;color:antiquewhite;background-color:rgba(0,0,0,0.5);top:1rem;text-align:center}.ImageViewer__overlayTop___2AckZ{top:0;left:95%;text-align:center}.ImageViewer__overlayRight___2JUTP{left:85%;text-align:center}.ImageViewer__hide___1aBrC{display:none}.ImageViewer__overlayLeft___38-fE{left:1%;text-align:left}.ImageViewer__imgContainer___3vJ9G{position:relative}.ImageViewer__imgContainer___3vJ9G:-ms-fullscreen>.ImageViewer__overlay___jS0Z0{display:inherit;top:2%}.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen>.ImageViewer__overlay___jS0Z0{display:inherit;top:2%}.ImageViewer__imgContainer___3vJ9G:-moz-full-screen>.ImageViewer__overlay___jS0Z0{display:inherit;top:2%}img.ImageViewer__active___1FrCT{max-height:100%;margin-left:auto;margin-right:auto;height:auto;max-width:100%;-webkit-transition-property:-webkit-transform;transition-property:transform, -webkit-transform;-webkit-transition-duration:0.2s;-o-transition-duration:0.2s;transition-duration:0.2s;-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out}.ImageViewer__imgContainer___3vJ9G:-ms-fullscreen>.ImageViewer__active___1FrCT{width:auto;max-height:100%}.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen{width:100%;height:100%;background-color:black}.ImageViewer__imgContainer___3vJ9G:-webkit-full-screen>.ImageViewer__active___1FrCT{width:auto}.ImageViewer__imgContainer___3vJ9G:-moz-full-screen>.ImageViewer__active___1FrCT{width:auto;max-height:100%}.ImageViewer__modalContainer___1MxZ7{position:absolute;height:100px;width:100%;z-index:75}.ImageViewer__tag___2mHoz{background-color:rgba(0,0,0,0.5);display:table}.ImageViewer__HotKeys___2ICLN:focus{outline:0}.ImageViewer__centerText___1e3gu{text-align:center}\n",""]),t.locals={inlineBlock:"ImageViewer__inlineBlock___3x7PU",overlay:"ImageViewer__overlay___jS0Z0",overlayTop:"ImageViewer__overlayTop___2AckZ",overlayRight:"ImageViewer__overlayRight___2JUTP",hide:"ImageViewer__hide___1aBrC",overlayLeft:"ImageViewer__overlayLeft___38-fE",imgContainer:"ImageViewer__imgContainer___3vJ9G",active:"ImageViewer__active___1FrCT",modalContainer:"ImageViewer__modalContainer___1MxZ7",tag:"ImageViewer__tag___2mHoz",HotKeys:"ImageViewer__HotKeys___2ICLN",centerText:"ImageViewer__centerText___1e3gu"},e.exports=t},112:function(e,t){},115:function(e,t,a){(t=a(23)(!1)).push([e.i,".Archive__container___3L_dg{margin:0 auto;padding:0;text-align:center}.Archive__titleContainer___3sRdJ{padding-top:50px}\n",""]),t.locals={container:"Archive__container___3L_dg",titleContainer:"Archive__titleContainer___3sRdJ"},e.exports=t},116:function(e,t,a){(t=a(23)(!1)).push([e.i,".Help__verticalCenter___2hUR-{-ms-flex-align:center;align-items:center}.Help__flex___2JJlN{display:-ms-flexbox;display:flex;-ms-flex-flow:row wrap;flex-flow:row wrap;list-style:none;background:rgba(0,0,0,0.9)}.Help__flex___2JJlN>*{-ms-flex:0 1 auto;flex:0 1 auto;max-width:100%;text-align:start}.Help__grow___4mrVI{-ms-flex-positive:1;flex-grow:1;color:#b8b5c0}.Help__noGrow___34bmx{-ms-flex-positive:0;flex-grow:0;color:lightblue}.Help__fullWidth___T7Iuq{width:100%}\n",""]),t.locals={verticalCenter:"Help__verticalCenter___2hUR-",flex:"Help__flex___2JJlN",grow:"Help__grow___4mrVI",noGrow:"Help__noGrow___34bmx",fullWidth:"Help__fullWidth___T7Iuq"},e.exports=t},117:function(e,t,a){(t=a(23)(!1)).push([e.i,".ArchiveCover__gallery___2XNvD{display:inline-block;vertical-align:top;text-align:center;background:#001a4c;font-weight:bold;position:relative;width:100%;border:1px solid grey;border-radius:2px}.ArchiveCover__gallery___2XNvD,a:hover{color:inherit;text-decoration:none}.ArchiveCover__coverTitle___3MvdX{max-height:28px;line-height:13px;padding:3px;overflow:hidden;width:100%;height:4em;font-size:0.85em}.ArchiveCover__extracted___2UiVm>a>.ArchiveCover__coverTitle___3MvdX{color:#00d0ff}.ArchiveCover__caption___1jseu{max-height:35px;line-height:15px;padding:3px;overflow:hidden;width:100%;z-index:10;font-size:0.85em;color:#a8a8a4}.ArchiveCover__imageContainer___C1fJ3{display:block;max-width:100%;height:auto;margin-left:auto;margin-right:auto}.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU{background:rgba(0,0,0,0.75);position:absolute;bottom:0;top:0;left:0;right:0;margin-top:28px;margin-bottom:21px;height:auto;width:100%;pointer-events:none;opacity:0;-webkit-transition:opacity 0.125s ease;-o-transition:opacity 0.125s ease;transition:opacity 0.125s ease}.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno{width:100%;height:100%;font-size:14px;font-weight:300;line-height:1.05;opacity:0;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;-webkit-transition:margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s;-o-transition:margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s;transition:margin 0.175s ease 0.125s, opacity 0.175s ease 0.175s}.ArchiveCover__gallery___2XNvD .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno .ArchiveCover__tag___jOY9w{width:100%;cursor:pointer}.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU{opacity:1;pointer-events:all}.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU .ArchiveCover__tags___GLbno{opacity:1}.ArchiveCover__gallery___2XNvD:hover .ArchiveCover__overlay___1wIAU .ArchiveCover__ListToggle___3cs9R{opacity:1}.ArchiveCover__queryTag___3IBHh{color:lightgreen}.ArchiveCover__smallButton___2ZAiq{margin:2px}\n",""]),t.locals={gallery:"ArchiveCover__gallery___2XNvD",coverTitle:"ArchiveCover__coverTitle___3MvdX",extracted:"ArchiveCover__extracted___2UiVm",caption:"ArchiveCover__caption___1jseu",imageContainer:"ArchiveCover__imageContainer___C1fJ3",overlay:"ArchiveCover__overlay___1wIAU",tags:"ArchiveCover__tags___GLbno",tag:"ArchiveCover__tag___jOY9w",ListToggle:"ArchiveCover__ListToggle___3cs9R",queryTag:"ArchiveCover__queryTag___3IBHh",smallButton:"ArchiveCover__smallButton___2ZAiq"},e.exports=t},118:function(e,t,a){(t=a(23)(!1)).push([e.i,"@media screen and (min-width: 1456px){.SidebarArchives__archCont___30IUp{width:12%}}@media screen and (max-width: 1455px){.SidebarArchives__archCont___30IUp{width:19%}}@media screen and (max-width: 1019px){.SidebarArchives__archCont___30IUp{width:24%}}@media screen and (max-width: 814px){.SidebarArchives__archCont___30IUp{width:32%}}@media screen and (max-width: 542px){.SidebarArchives__archCont___30IUp{width:49%}}@media screen and (max-width: 300px){.SidebarArchives__archCont___30IUp{width:100%}}\n",""]),t.locals={archCont:"SidebarArchives__archCont___30IUp"},e.exports=t},119:function(e,t,a){(t=a(23)(!1)).push([e.i,".Home__inlineBlock___33Dcx{display:inline-block;width:55px}.Home__container___KkeO7{position:relative}.Home__overlay___1L6jf{position:absolute;max-width:100%;height:20px;z-index:10;color:antiquewhite;background-color:rgba(0,0,0,0.5);top:1rem;text-align:center}.Home__overlayTop___1g6qW{top:0;left:95%;text-align:center}.Home__overlayHelp___1USgm{position:absolute;left:85%}.Home__overlayRight___AiZmH{position:absolute;right:1%;top:0;z-index:5}.Home__overlayLeft___JWQEH{position:absolute;left:1%;z-index:5}.Home__overlayLogs___MgyWx{position:absolute;right:15%;z-index:5}.Home__imgContainer___3M7tW{position:relative}.Home__imgContainer___3M7tW:-ms-fullscreen>.Home__overlay___1L6jf{display:inherit;top:2%}.Home__imgContainer___3M7tW:-webkit-full-screen>.Home__overlay___1L6jf{display:inherit;top:2%}.Home__imgContainer___3M7tW:-moz-full-screen>.Home__overlay___1L6jf{display:inherit;top:2%}img.Home__active___2X6FD{max-height:100%;margin-left:auto;margin-right:auto;height:auto;max-width:100%}.Home__imgContainer___3M7tW:-ms-fullscreen>.Home__active___2X6FD{width:auto;max-height:100%}.Home__imgContainer___3M7tW:-webkit-full-screen{width:100%;max-height:100%;background-color:black}.Home__imgContainer___3M7tW:-webkit-full-screen>.Home__active___2X6FD{max-height:100%}.Home__imgContainer___3M7tW:-moz-full-screen>.Home__active___2X6FD{width:auto;max-height:100%}.Home__modalContainer___DzRT5{position:absolute;height:100px;width:100%;top:6%;z-index:80}.Home__tag___30qLH{background-color:rgba(0,0,0,0.5);display:table}.Home__HotKeys___3qY1w:focus{outline:0}.Home__popOver___2VSiP{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column;padding:5px;background:#454545;color:white;border-radius:0.3rem;font-size:0.9em;position:absolute;left:15%}.Home__logLevel-important___lcdrk{color:#93e6fc}.Home__logLevel-normal___10jOk{color:white}.Home__logLevel-error___1opE-{color:#bd2130}.Home__logLevel-warning___1Q5jK{color:#e0a800}\n",""]),t.locals={inlineBlock:"Home__inlineBlock___33Dcx",container:"Home__container___KkeO7",overlay:"Home__overlay___1L6jf",overlayTop:"Home__overlayTop___1g6qW",overlayHelp:"Home__overlayHelp___1USgm",overlayRight:"Home__overlayRight___AiZmH",overlayLeft:"Home__overlayLeft___JWQEH",overlayLogs:"Home__overlayLogs___MgyWx",imgContainer:"Home__imgContainer___3M7tW",active:"Home__active___2X6FD",modalContainer:"Home__modalContainer___DzRT5",tag:"Home__tag___30qLH",HotKeys:"Home__HotKeys___3qY1w",popOver:"Home__popOver___2VSiP","logLevel-important":"Home__logLevel-important___lcdrk","logLevel-normal":"Home__logLevel-normal___10jOk","logLevel-error":"Home__logLevel-error___1opE-","logLevel-warning":"Home__logLevel-warning___1Q5jK"},e.exports=t},120:function(e,t,a){(t=a(23)(!1)).push([e.i,".ArchiveSelect__modalContainer___3hKCa{position:relative;height:100px;width:900px;margin-left:auto;margin-right:auto}\n",""]),t.locals={modalContainer:"ArchiveSelect__modalContainer___3hKCa"},e.exports=t},121:function(e,t,a){"use strict";a.r(t);var i=a(0),o=a.n(i),r=a(27),s=a.n(r),n=(a(72),a(73),a(28)),l=a(7),c=a(37),h=a(5),_=a.n(h),d=a(127),g=a(126),m=a(61),p=a.n(m),u=a(38),v=a(26),y=a.n(v),f=a(122),C=a(123),w=a(124),b=a(62),x=a.n(b);var P=({className:e,currentPosition:t,lastPosition:a,navSelectOptions:i,handleChange:r,moveLeft:s,moveFirst:n,moveRight:l,moveLast:c})=>o.a.createElement(f.a,{listClassName:"justify-content-center my-0"},o.a.createElement(C.a,null,o.a.createElement(w.a,{onClick:n},"\u2190\u2190")),o.a.createElement(C.a,null,o.a.createElement(w.a,{onClick:s},"\u2190")),o.a.createElement(C.a,null,o.a.createElement("div",{className:x.a.midItem},o.a.createElement(u.a,{className:e,name:"select-page",value:{value:t,label:t},onChange:r,options:i,isClearable:!1,blurInputOnSelect:!0,noOptionsMessage:()=>"No valid option"}),o.a.createElement("span",{style:{verticalAlign:"super"}},` of ${a} `))),o.a.createElement(C.a,null,o.a.createElement(w.a,{onClick:l},"\u2192")),o.a.createElement(C.a,null,o.a.createElement(w.a,{onClick:c},"\u2192\u2192"))),I=a(125);var E=({images:e})=>o.a.createElement("div",{style:{position:"absolute",left:"85%",top:"16%",width:"15%"}},Object.keys(e).map(t=>{const a=e[Number(t)].percent;switch(e[Number(t)].state){case"progress":return o.a.createElement(I.a,{key:t,color:a<0?"warning":"success",value:a},`${t}: ${a}%`);case"load":return o.a.createElement(I.a,{key:t,color:"info",value:a},`${t}: ${a}%`);case"error":case"abort":return o.a.createElement(I.a,{key:t,color:"danger",value:a},`${t}: ${a}%`);default:return o.a.createElement(I.a,{key:t,color:"info",value:a},`${t}: ${a}%`)}})),k=a(9),S=a.n(k),A=a(63),H=a.n(A);const M={basename:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PB_HOST_URL||"/new-image-viewer",PandaBackupUrl:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PB_SERVER||"",PandaBackupKey:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_PB_KEY||""};async function O(e,t){let a;a=""===M.PandaBackupKey?"":"&api_key="+M.PandaBackupKey;const i=`${M.PandaBackupUrl}/r-api/archive/${e}/?position=${t||1}${a}`,o=await fetch(i,{credentials:"include"});return await o.json()}async function N(e){let t;t=""===e?"?api_key="+M.PandaBackupKey:"&api_key="+M.PandaBackupKey;const a=`${M.PandaBackupUrl}/r-api/archives/${e}${t}`,i=await fetch(a,{credentials:"include"});return await i.json()}function L(e){const t=Math.log(e)/Math.log(1024)|0;return`${(e/1024**t).toFixed(2)} ${0===t?"bytes":"KMGTPEZY"[t-1]+"B"}`}function T(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function j(e,t,a,i){let o=e-i,r=e+i;return o<t&&(o=t),r>a&&(r=a),[new Array(e-o).fill(0).map((t,a)=>e-a-1),new Array(r-e).fill(0).map((t,a)=>a+e+1)]}function D(e,t){const a=t[0].length+t[1].length,i=[];for(let o=0;o<a;o++)for(let e=0;e<2;e++)t[e].length-1<o||i.push(t[e][o]);return[e,...i]}function F(e,t,a,i,o){let r,s;return a?e>=i?(r=i,s=r*t/e):(r=e,s=t):e>=o?(r=o,s=r*t/e):(r=e,s=t),[r,s]}const $={moveLeft:["left","a"],moveRight:["right","d"],moveFirst:"shift+left",moveLast:"shift+right",previousQueue:"y",nextQueue:"i",togglePositionModal:"u"};class R extends i.Component{constructor(e){super(e),T(this,"node",void 0),T(this,"imgContainer",void 0),T(this,"modalInput",void 0),T(this,"slider",void 0),T(this,"updateProgress",e=>{const t=e.currentTarget;e.lengthComputable?this.setState({images:y()(this.state.images,{[Number(t.id)]:{$merge:{percent:e.loaded/e.total}}})}):this.setState({images:y()(this.state.images,{[Number(t.id)]:{$merge:{percent:-1}}})})}),T(this,"transferComplete",e=>{const t=e.currentTarget;this.setState({images:y()(this.state.images,{[Number(t.id)]:{$merge:{percent:100,state:"load"}}})})}),T(this,"transferFailed",e=>{const t=e.currentTarget;this.setState({images:y()(this.state.images,{[Number(t.id)]:{$merge:{state:"error"}}})})}),T(this,"transferCanceled",e=>{const t=e.currentTarget;this.setState({images:y()(this.state.images,{[Number(t.id)]:{$merge:{state:"abort"}}})})}),T(this,"getImagesData",e=>{e.filter(e=>!{}.hasOwnProperty.call(this.state.images,e.position)).forEach(e=>{const t=new window.Image;t.id=e.position.toString(),t.addEventListener("progress",this.updateProgress),t.addEventListener("load",this.transferComplete),t.addEventListener("error",this.transferFailed),t.addEventListener("abort",this.transferCanceled),t.src=e.url,this.setState({images:y()(this.state.images,{[e.position]:{$set:{position:e.position,url:e.url,width:e.width,height:e.height,is_horizontal:e.is_horizontal,state:"progress",percent:0}}})})})}),T(this,"getNonCachedImagesUrls",(e,t)=>{const a=t.filter(e=>!{}.hasOwnProperty.call(this.state.images,e));0!==a.length&&async function(e,t){const a=H.a.stringify({i:t},{indices:!1});let i;i=""===M.PandaBackupKey?"":"&api_key="+M.PandaBackupKey;const o=`${M.PandaBackupUrl}/r-api/archive/${e}/image_list/?${a}${i}`,r=await fetch(o,{credentials:"include"});return await r.json()}(e,a).then(e=>this.getImagesData(e))}),T(this,"goToPosition",e=>{e!==this.state.currentPosition&&this.props.history.replace(`/${this.props.archive.id}/img/${e}${this.props.location.search}`)}),T(this,"handleImgClick",e=>{!function(e){const t=e.currentTarget;let a=0,i=t;for(;i;)a+=i.offsetLeft,i=i.offsetParent;return t.style.paddingLeft&&(a+=Number(t.style.paddingLeft.match(/\d+/)[0])),a-=window.scrollX,(e.clientX-a)/(t.width||t.offsetWidth)>.5}(e)?this.moveLeft():this.moveRight()}),T(this,"handleSliderChange",e=>{this.goToPosition(e+1)}),T(this,"moveLeft",()=>{this.props.doublePageMode&&this.state.navImages[0].length>1?this.handlePositionChanges(this.state.navImages[0][1]):this.state.navImages[0].length>0&&this.handlePositionChanges(this.state.navImages[0][0])}),T(this,"moveRight",()=>{this.props.doublePageMode&&this.state.navImages[1].length>1?this.handlePositionChanges(this.state.navImages[1][1]):this.state.navImages[1].length>0&&this.handlePositionChanges(this.state.navImages[1][0])}),T(this,"moveFirst",()=>{this.handlePositionChanges(this.props.startPosition)}),T(this,"moveLast",()=>{this.handlePositionChanges(this.props.archive.lastPosition)}),T(this,"handlePositionModalGoTo",e=>{this.handlePositionChanges(e.value)}),T(this,"handlePositionChanges",e=>{this.goToPosition(e),this.props.displayCovers&&this.slider.slickGoTo(e-1)}),T(this,"togglePositionModal",()=>{this.setState({showPositionModal:!this.state.showPositionModal}),this.state.showPositionModal&&this.modalInput&&this.modalInput.current&&this.modalInput.current.focus(),!this.state.showPositionModal&&this.modalInput&&this.modalInput.current&&this.modalInput.current.blur()}),T(this,"correctWith",e=>e.is_horizontal?e.width>=this.state.horizontal?this.state.horizontal:e.width:e.width>=this.state.vertical?this.state.vertical:e.width),T(this,"getDisplayImage",(e,t,a)=>o.a.createElement("img",{key:e.url,className:S.a.active,src:e.url,alt:"",width:t?"auto":this.correctWith(e),height:e.height,style:a})),T(this,"keyHandlers",{moveLeft:this.moveLeft,moveRight:this.moveRight,moveFirst:this.moveFirst,moveLast:this.moveLast,previousQueue:()=>this.props.handleQueueChange(this.props.archive.id,-1),nextQueue:()=>this.props.handleQueueChange(this.props.archive.id,1),togglePositionModal:e=>{this.togglePositionModal(),e.preventDefault()}}),this.modalInput=o.a.createRef();const t={};if(e.archive.startImage){const[a,i]=F(e.archive.startImage.width,e.archive.startImage.height,e.archive.startImage.is_horizontal,1500,900);e.archive.startImage&&(t[e.startIndex]={position:e.startIndex,url:e.archive.startImage.url,width:a,height:i,is_horizontal:e.archive.startImage.is_horizontal,state:"load",percent:100})}this.state={currentArchiveId:e.archive.id,currentPosition:e.startIndex,positionModal:e.startIndex,horizontal:1500,vertical:900,showPositionModal:!1,loading:!0,navImages:j(e.startIndex,e.startPosition,e.archive.lastPosition,e.preloadCount),images:t}}componentDidMount(){this.getNonCachedImagesUrls(this.props.archive.id,D(this.state.currentPosition,[this.state.navImages[1],this.state.navImages[0]])),this.node&&this.node.scrollIntoView(),this.props.displayCovers&&this.slider.slickGoTo(this.state.currentPosition-1),this.props.setCurrentContainer(this.imgContainer)}static getDerivedStateFromProps(e,t){const a=e.archive.id,i=t.currentArchiveId,o=e.startIndex,r=t.currentPosition;if(a!==i){const i={};if(e.archive.startImage){const[a,o]=F(e.archive.startImage.width,e.archive.startImage.height,e.archive.startImage.is_horizontal,t.horizontal,t.vertical);e.archive.startImage&&(i[e.startIndex]={position:e.startIndex,url:e.archive.startImage.url,width:a,height:o,is_horizontal:e.archive.startImage.is_horizontal,state:"load",percent:100})}return{currentArchiveId:a,currentPosition:e.startIndex,positionModal:e.startIndex,loading:!0,navImages:j(e.startIndex,e.startPosition,e.archive.lastPosition,e.preloadCount),images:i}}return o!==r?{loading:!0,navImages:j(o,e.startPosition,e.archive.lastPosition,e.preloadCount),currentPosition:o,positionModal:o}:null}componentDidUpdate(e){const t=this.props.archive.id,a=e.archive.id,i=this.props.startIndex,o=e.startIndex;t!==a||i!==o?(this.getNonCachedImagesUrls(t,D(this.state.currentPosition,[this.state.navImages[1],this.state.navImages[0]])),this.imgContainer&&this.imgContainer.scrollIntoView()):this.props.displayAllPreloaded!=e.displayAllPreloaded&&this.imgContainer&&this.imgContainer.scrollIntoView(),this.props.displayCovers&&this.slider.slickGoTo(this.state.currentPosition-1)}componentWillUnmount(){this.props.setCurrentContainer(null)}render(){const{showPositionModal:e,currentPosition:t,images:a,navImages:i}=this.state,{displayCovers:r,displayNavigators:s,displayMetadata:n,autoWidth:l,displayPreloadInfo:h,doublePageMode:d,displayAllPreloaded:m,scale:v}=this.props,{lastPosition:y}=this.props.archive,f=n&&o.a.createElement("div",{className:_()(S.a.overlay,S.a.overlayLeft)},o.a.createElement("h6",{className:S.a.tag},this.props.archive.title),o.a.createElement("div",{className:S.a.tag},`Pages: ${this.props.archive.filecount} | Size: ${L(this.props.archive.filesize)} | `,o.a.createElement("a",{href:""+this.props.archive.url},"Source")),this.props.archive.tags.map(e=>o.a.createElement("div",{className:S.a.tag,key:e},""+e))),C={transform:`scaleX(${v}) scaleY(${v})`,transformOrigin:"center top"},w=[];let b=[],x=[];m&&(b=i[0].filter(e=>void 0!==a[e]).reverse().map(e=>o.a.createElement("div",{key:e},this.getDisplayImage(a[e],l,C))),x=i[1].filter(e=>void 0!==a[e]&&(!d||e!=t+1)).map(e=>o.a.createElement("div",{key:e},this.getDisplayImage(a[e],l,C)))),d&&t<y&&a[t+1]&&w.push(this.getDisplayImage(a[t+1],l,C)),a[t]&&w.push(this.getDisplayImage(a[t],l,C));const I=r&&new Array(y).fill(0).map((e,t)=>({}.hasOwnProperty.call(a,t+1)?o.a.createElement("div",{key:a[t+1].url,style:{width:210,height:285}},o.a.createElement("img",{className:"img-fluid mx-auto",src:a[t+1].url,alt:"",width:200,height:"auto"})):o.a.createElement("div",{key:String(t+1),style:{width:210,height:285}},o.a.createElement("h3",null,"Not loaded")))),k=new Array(y).fill(0).map((e,t)=>({value:t+1,label:t+1})),A=e&&o.a.createElement("div",{className:S.a.modalContainer},o.a.createElement(u.a,{className:S.a.inlineBlock,name:"select-page-fast",value:{value:t,label:t},onChange:this.handlePositionModalGoTo,options:k,clearable:!1,autoBlur:!0,openOnFocus:!0,onClose:this.togglePositionModal,noResultsText:"No valid page",ref:this.modalInput})),H=h&&o.a.createElement(E,{images:a});return o.a.createElement(c.GlobalHotKeys,{className:S.a.HotKeys,keyMap:$,handlers:this.keyHandlers},o.a.createElement("div",{ref:e=>this.node=e},o.a.createElement("h6",null,this.props.archive.title),r&&o.a.createElement(p.a,{dots:!1,infinite:!1,speed:0,slidesToShow:3,slidesToScroll:1,focusOnSelect:!0,centerMode:!0,centerPadding:"0",ref:e=>{this.slider=e},variableWidth:!0,initialSlide:this.props.startIndex-1,afterChange:this.handleSliderChange},I),s&&o.a.createElement(P,{className:S.a.inlineBlock,currentPosition:t,lastPosition:y,moveFirst:this.moveFirst,moveLeft:this.moveLeft,moveRight:this.moveRight,moveLast:this.moveLast,handleChange:this.handlePositionModalGoTo,navSelectOptions:k}),H,b?o.a.createElement("div",{id:"img-previous",className:S.a.imgContainer},b):null,o.a.createElement("div",{id:"img-display",className:S.a.imgContainer,onClick:this.handleImgClick,ref:e=>this.imgContainer=e},A,a[t]?w:o.a.createElement("div",null,o.a.createElement("h5",null,"Current image is loading..."),o.a.createElement(g.a,{style:{width:"3rem",height:"3rem"},color:"primary"})),o.a.createElement("div",{className:_()(S.a.overlay,S.a.overlayTop,S.a.hide)},o.a.createElement("span",{id:"img-counter"},t),"/",y),f),x?o.a.createElement("div",{id:"img-next",className:S.a.imgContainer},x):null))}}var V=Object(l.e)(R),z=a(51),U=a.n(z);function W(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class K extends i.Component{constructor(...e){super(...e),W(this,"state",{archive:null,runningAction:!1}),W(this,"onExtractClick",()=>{this.state.runningAction||!this.state.archive||this.state.archive.extracted||this.handleArchiveAction(this.state.archive.id,"extract_archive")}),W(this,"handleArchiveAction",(e,t)=>{this.setState({runningAction:!0}),async function(e,t){let a;a=""===M.PandaBackupKey?"":"&api_key="+M.PandaBackupKey;const i=`${M.PandaBackupUrl}/r-api/archive/${e}/${t}/?${a}`,o=await fetch(i,{credentials:"include"});return await o.json()}(e,t).then(a=>{if("ok"===a.result){const{archive:i}=this.state;"extracted"===a.change.field&&(i[a.change.field]="true"===a.change.value.toString(),this.setState({archive:i})),this.props.createLog(`Archive ${e} executed action ${t} successfully`,"normal")}else this.props.createLog(`Archive ${e} executed action ${t} with response ${a.message}: ${a.result}`,"normal");this.setState({runningAction:!1}),this.props.handleForceUpdateArchives()}).catch(a=>this.props.createLog(`Archive ${e} executed action ${t} with async error: ${a}`,"normal"))})}componentDidMount(){O(this.props.match.params.archiveId,Number(this.props.match.params.imgId)).then(e=>{this.setState({archive:e}),document.title=e.title})}componentDidUpdate(e){const t=e.match.params.archiveId,a=this.props.match.params.archiveId,i=this.props.match.params.imgId;a!==t&&O(a,Number(i)).then(e=>{this.setState({archive:e}),document.title=e.title})}render(){const{archive:e,runningAction:t}=this.state,{match:a,handleQueueChange:i,displayCovers:r,displayNavigators:s,displayMetadata:n,autoWidth:l,displayPreloadInfo:c,doublePageMode:h,setCurrentContainer:_,scale:m,preloadCount:p,displayAllPreloaded:u}=this.props;return o.a.createElement("div",{className:U.a.container},e?e.extracted?o.a.createElement(V,{startIndex:Number(a.params.imgId),archive:e,startPosition:1,handleQueueChange:i,displayCovers:r,displayNavigators:s,displayMetadata:n,displayPreloadInfo:c,doublePageMode:h,displayAllPreloaded:u,setCurrentContainer:_,autoWidth:l,scale:m,preloadCount:p}):o.a.createElement("div",null,o.a.createElement("h6",null,e.title),o.a.createElement("h6",null,"Archive needs to be extracted before using it in here."),o.a.createElement(d.a,{onClick:this.onExtractClick,size:"sm",disabled:t},"Extract Archive")):o.a.createElement(g.a,{className:U.a.titleContainer,style:{width:"3rem",height:"3rem"},color:"primary"}))}}var B=K,Q=a(21),q=a.n(Q);var G=({actions:e})=>o.a.createElement("div",{className:q.a.flex},o.a.createElement("div",{className:_()(q.a.verticalCenter,q.a.fullWidth)},"Keyboard shortcuts"),e.map(e=>o.a.createElement("div",{className:_()(q.a.verticalCenter,q.a.flex,q.a.fullWidth),key:e.key},o.a.createElement("div",{className:_()(q.a.grow)},e.description),o.a.createElement("div",{className:_()(q.a.noGrow)},e.key)))),J=a(19),X=a.n(J);function Z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(a),!0).forEach((function(t){ee(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ee(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const te=({src:e,title:t,height:a,width:i,className:r})=>{const s={maxHeight:290,width:i},n={height:"auto",maxWidth:"100%",maxHeight:a,border:"1px solid #ccc"};return o.a.createElement("div",{className:r,style:Y({},s)},o.a.createElement("img",{style:n,src:e,alt:t,height:a,width:i}))};te.defaultProps={width:200,height:290};var ae=te,ie=a.p+"static/media/no_cover.8e25d57e.png";var oe=Object(l.e)(({archive:e,location:t})=>{const a=e.image?e.image:ie,i=e.tags.map(e=>o.a.createElement("div",{className:X.a.tag,key:e},""+e));return o.a.createElement("div",{className:_()(X.a.gallery,e.extracted?X.a.extracted:null)},o.a.createElement(n.b,{to:`/${e.id}/img/1${t.search}`},o.a.createElement("div",{className:X.a.coverTitle,title:e.title},e.title),o.a.createElement(ae,{className:X.a.imageContainer,src:a,title:e.title,width:e.image_width,height:e.image_height}),o.a.createElement("div",{className:X.a.overlay},o.a.createElement("div",{className:X.a.tags},i))),o.a.createElement("div",null,o.a.createElement("div",{className:X.a.caption},`${e.filecount} | ${L(e.filesize)} | `,o.a.createElement("a",{className:_()(X.a.link,X.a.highlight),href:""+e.url},"SRC"))))});const re={position:"absolute",top:"0px"};var se=({onClick:e,showContent:t,alignRight:a})=>{let i;const r=a?">":"<",s=a?"<":">";return i=t?Object.assign({},re,a?{left:"-30px"}:{right:"-30px"}):Object.assign({},re,a?{right:"0"}:{left:"0"}),o.a.createElement(d.a,{onClick:e,size:"sm",style:i},t?r:s)},ne=a(64),le=a.n(ne);var ce=({displayQueue:e,archives:t,toggleQueue:a,className:i})=>o.a.createElement("div",{className:_()(i,e?le.a.archCont:null)},e?t.objects.map(e=>o.a.createElement("div",{key:e.id},o.a.createElement(oe,{archive:e}))):null,o.a.createElement(se,{onClick:a,showContent:e,alignRight:!1}));var he=({displayControls:e,toggleControls:t,className:a,controls:i})=>o.a.createElement("div",{className:a},o.a.createElement("div",null,e?i.map(e=>o.a.createElement("div",{key:e.key},o.a.createElement(d.a,{onClick:e.action,color:"primary",size:"sm",block:!0},e.description))):null,o.a.createElement(se,{onClick:t,showContent:e,alignRight:!0}))),_e=a(20),de=a.n(_e),ge=a(65),me=a(66),pe=a.n(me);function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function ve(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(a),!0).forEach((function(t){ye(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ye(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const fe={menu:(e,t)=>ve(ve({},e),{},{color:t.selectProps.menuColor})};var Ce=function({handleQueryChange:e}){const[,t]=Object(i.useState)(""),[a,r]=Object(i.useState)(null);return o.a.createElement("div",{className:pe.a.modalContainer},o.a.createElement(ge.a,{cacheOptions:!0,defaultOptions:[],value:a,getOptionLabel:e=>e.title,getOptionValue:e=>e.id,loadOptions:e=>async function(e){const t=`${M.PandaBackupUrl}/title-suggest/?q=${e}`,a=await fetch(t,{credentials:"include"});return await a.json()}(e),onInputChange:e=>{t(e)},onChange:t=>{r(t),e(t.id)},menuColor:"black",styles:fe}))};function we(){return(we=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e}).apply(this,arguments)}function be(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class xe extends i.Component{constructor(e){super(e),be(this,"state",{archives:null,displayQueue:!1,displayHelp:!1,displayControls:!1,currentArchive:null,displayCovers:!1,displayNavigators:!0,displayMetadata:!1,displayPreloadInfo:!1,doublePageMode:!1,autoWidth:!1,scale:1,preloadCount:5,currentContainer:null,displayAllPreloaded:!1,showSearchArchiveModal:!1,logs:[{id:0,level:"normal",text:"Image Viewer started"}],showAllLogs:!1}),be(this,"_HotKeysContainer",void 0),be(this,"toggleFullSize",()=>{this.setState({autoWidth:!this.state.autoWidth})}),be(this,"toggleMetadata",()=>{this.setState({displayMetadata:!this.state.displayMetadata})}),be(this,"toggleDoublePageMode",()=>{this.setState({doublePageMode:!this.state.doublePageMode})}),be(this,"decreaseScale",()=>{this.setState({scale:this.state.scale-.1})}),be(this,"increaseScale",()=>{this.setState({scale:this.state.scale+.1})}),be(this,"resetScale",()=>{this.setState({scale:1})}),be(this,"togglePreloadInfo",()=>{this.setState({displayPreloadInfo:!this.state.displayPreloadInfo})}),be(this,"toggleHelp",()=>{this.setState({displayHelp:!this.state.displayHelp})}),be(this,"toggleCovers",()=>{this.setState({displayCovers:!this.state.displayCovers})}),be(this,"toggleQueue",()=>{this.setState({displayQueue:!this.state.displayQueue})}),be(this,"togglePreloadCount",()=>{this.setState({preloadCount:5==this.state.preloadCount?1:5})}),be(this,"toggleControls",()=>{this.setState({displayControls:!this.state.displayControls})}),be(this,"setCurrentContainer",e=>{this.setState({currentContainer:e})}),be(this,"contentFullScreen",()=>{if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen();else{const e=this.state.currentContainer;e&&(e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen())}}),be(this,"toggleAllPreloaded",()=>{this.setState({displayAllPreloaded:!this.state.displayAllPreloaded})}),be(this,"toggleSearchArchiveModal",()=>{this.setState({showSearchArchiveModal:!this.state.showSearchArchiveModal})}),be(this,"toggleAllLogs",()=>{this.setState({showAllLogs:!this.state.showAllLogs})}),be(this,"actions",[{key:"left, a",name:"moveLeft",description:"Move Left"},{key:"right, d, space",name:"moveRight",description:"Move Right"},{key:"shift+left",name:"moveFirst",description:"Move First"},{key:"shift+right",name:"moveLast",description:"Move Last"},{key:"y",name:"previousQueue",description:"Previous in queue"},{key:"i",name:"nextQueue",description:"Next in queue"},{key:"h",name:"toggleHelp",description:"Toggle help"},{key:"p",name:"toggleQueue",description:"Toggle queue"},{key:"l",name:"toggleControls",description:"Toggle controls"},{key:"-",name:"decreaseScale",description:"Decrease Scale",action:this.decreaseScale},{key:"+",name:"increaseScale",description:"Increase Scale",action:this.increaseScale},{key:"=",name:"resetScale",description:"Reset Scale",action:this.resetScale},{key:"g",name:"toggleFullSize",description:"Full Size",action:this.toggleFullSize},{key:"f",name:"toggleFullScreen",description:"Full Screen",action:this.contentFullScreen},{key:"o",name:"toggleAllPreloaded",description:"Display all preloaded",action:this.toggleAllPreloaded},{key:"z",name:"toggleSearchArchiveModal",description:"Display Simple Archive search",action:this.toggleSearchArchiveModal},{key:"c",name:"toggleCovers",description:"Covers"},{key:"t",name:"toggleDoublePageMode",description:"Double page mode",action:this.toggleDoublePageMode},{key:"u",name:"togglePositionModal",description:"Position Modal"},{key:"j",name:"toggleMetadata",description:"Metadata",action:this.toggleMetadata},{key:"shift+p",name:"togglePreloadCount",description:"Preload Count",action:this.togglePreloadCount},{key:"shift+j",name:"togglePreloadInfo",description:"Preload Info",action:this.togglePreloadInfo},{key:"shift+l",name:"toggleAllLogs",description:"Show Logs",action:this.toggleAllLogs}]),be(this,"keyHandlers",{togglePreloadInfo:this.togglePreloadInfo,decreaseScale:this.decreaseScale,increaseScale:this.increaseScale,resetScale:this.resetScale,toggleFullSize:this.toggleFullSize,toggleCovers:this.toggleCovers,toggleDoublePageMode:this.toggleDoublePageMode,toggleHelp:this.toggleHelp,toggleMetadata:this.toggleMetadata,toggleQueue:this.toggleQueue,toggleControls:this.toggleControls,toggleFullScreen:this.contentFullScreen,togglePreloadCount:this.togglePreloadCount,toggleAllPreloaded:this.toggleAllPreloaded,toggleSearchArchiveModal:this.toggleSearchArchiveModal,toggleAllLogs:this.toggleAllLogs}),be(this,"handleQueueChange",(e,t)=>{if(this.state.archives){const a=this.state.archives.objects.findIndex(t=>t.id===e);if(a>-1&&this.state.archives){const e=a+t;e>=0&&e<this.state.archives.objects.length&&this.props.history.push(`/${this.state.archives.objects[e].id}/img/1${this.props.location.search}`)}}}),be(this,"handleForceUpdateArchives",()=>{N(this.props.location.search).then(e=>{this.setState({archives:e})})}),be(this,"handleGoToArchive",e=>{this.props.history.push(`/${e}/img/1${this.props.location.search}`),this.setState({showSearchArchiveModal:!1})}),be(this,"createLog",(e,t)=>{this.setState(a=>({logs:[{id:a.logs.length,level:t,text:e},...a.logs]}))}),this._HotKeysContainer=o.a.createRef()}componentDidMount(){this._HotKeysContainer&&this._HotKeysContainer.current&&this._HotKeysContainer.current.focus(),N(this.props.location.search).then(e=>{this.setState({archives:e})})}componentDidUpdate(e){const t=e.location.search,a=this.props.location.search;a!==t&&N(a).then(e=>{this.setState({archives:e})})}componentWillUnmount(){}render(){const{archives:e,displayQueue:t,displayHelp:a,displayCovers:i,displayNavigators:r,displayMetadata:s,autoWidth:n,displayPreloadInfo:h,doublePageMode:d,displayControls:g,scale:m,preloadCount:p,displayAllPreloaded:u,logs:v,showAllLogs:y,showSearchArchiveModal:f}=this.state,C=v.map(e=>o.a.createElement("div",{className:de.a["logLevel-"+e.level],key:e.id},""+e.text)),{match:w}=this.props,b=f&&o.a.createElement("div",{className:de.a.modalContainer},o.a.createElement(Ce,{handleQueryChange:this.handleGoToArchive}));return o.a.createElement(c.HotKeys,{className:de.a.HotKeys,innerRef:this._HotKeysContainer,keyMap:this.actions.filter(e=>this.keyHandlers.hasOwnProperty(e.name)).reduce((e,t)=>(e[t.name]=t.key,e),{}),handlers:this.keyHandlers},o.a.createElement("div",null,o.a.createElement("div",{className:de.a.container},e?o.a.createElement(ce,{className:de.a.overlayLeft,archives:e,displayQueue:t,toggleQueue:this.toggleQueue}):null,y?o.a.createElement(Pe,{lines:C}):null,o.a.createElement("div",{style:{position:"relative"}},b,o.a.createElement(l.a,{path:w.url+":archiveId/img/:imgId",render:e=>o.a.createElement(B,we({handleQueueChange:this.handleQueueChange,handleForceUpdateArchives:this.handleForceUpdateArchives,createLog:this.createLog,displayCovers:i,displayNavigators:r,displayMetadata:s,displayPreloadInfo:h,displayAllPreloaded:u,showSearchArchiveModal:f,doublePageMode:d,setCurrentContainer:this.setCurrentContainer,autoWidth:n,scale:m,preloadCount:p},e))})),a&&o.a.createElement("div",{className:_()(de.a.overlay,de.a.overlayHelp)},o.a.createElement(G,{actions:this.actions})),o.a.createElement(he,{className:de.a.overlayRight,displayControls:g,toggleControls:this.toggleControls,controls:this.actions.filter(e=>void 0!==e.action)}))))}}const Pe=({lines:e})=>o.a.createElement("div",{className:de.a.popOver},e);var Ie=Object(l.e)(xe);var Ee=()=>o.a.createElement(o.a.StrictMode,null,o.a.createElement(n.a,{basename:M.basename},o.a.createElement(l.a,{path:"/",component:Ie})));const ke=document.getElementById("root");null!==ke&&s.a.render(o.a.createElement(Ee,null),ke)},19:function(e,t,a){var i=a(22),o=a(117);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},20:function(e,t,a){var i=a(22),o=a(119);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},21:function(e,t,a){var i=a(22),o=a(116);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},51:function(e,t,a){var i=a(22),o=a(115);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},62:function(e,t,a){var i=a(22),o=a(93);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},64:function(e,t,a){var i=a(22),o=a(118);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},66:function(e,t,a){var i=a(22),o=a(120);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},67:function(e,t,a){e.exports=a(121)},72:function(e,t,a){},73:function(e,t,a){},9:function(e,t,a){var i=a(22),o=a(102);"string"===typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var r={insert:"head",singleton:!1};i(o,r);e.exports=o.locals||{}},93:function(e,t,a){(t=a(23)(!1)).push([e.i,".NavigationPager__midItem___1cqZa{padding:0.25rem 0.75rem;line-height:1.25;color:#ddd;background-color:#0e1339;border:1px solid #dee2e6}\n",""]),t.locals={midItem:"NavigationPager__midItem___1cqZa"},e.exports=t}},[[67,1,2]]]);
//# sourceMappingURL=main.02765c00.chunk.js.map